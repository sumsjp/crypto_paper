1. [摘要](#S1)
2. [研究角度](#S2)
3. [研究方法](#S3)
4. [研究結果](#S4)
5. [研究結論](#S5)


# Transfer Ranking in Finance: Applications to Cross-Sectional Momentum with Data Scarcity


<a name="S1"></a>
## 1. **摘要**

現代跨橫斷面交易策略中，結合了**深度學習 (Deep Learning, DL)** 的先進神經網絡模型在歷史數據充足的成熟資產上能夠超越傳統方法。然而，當應用於交易數據有限的標的時，這些模型容易**過擬合 (overfitting)**，導致績效下降。

本研究提出了一種新方法——**Fused Encoder Networks (FEN)**，這是一種混合的參數共享**遷移學習排名模型 (Transfer Ranking Model)**。該模型利用 **編碼器-注意力模塊 (encoder-attention module)** 來融合從大數據集（源數據）中提取的信息，以及針對目標數據集的專用模塊，以提升模型的**泛化能力 (generalizability)**。

**方法與創新**：  
- 採用 **自注意力機制 (self-attention mechanism)**，允許模型在訓練和推理過程中考慮不同資產間的相互作用。
- 透過混合學習策略，在源數據集（例如外匯數據）上訓練部分模型，並與針對目標數據（例如加密貨幣）訓練的模組相結合，從而降低過擬合風險。

**實驗與結果**：  
- 研究將 FEN 應用於 **前十大加密貨幣的動能交易策略**（基於市值排名），並與現有最先進的基準方法進行比較。  
- 在大多數評估指標上，FEN **優於其他方法**，特別是在風險調整後回報方面，如 **Sharpe Ratio** 顯著提高。  
- 即使考慮**高交易成本**（如加密貨幣市場的手續費與滑點），FEN 仍能保持優異的交易表現。  

**結論與影響**：  
FEN 有效解決了**數據稀缺環境下的金融交易建模問題**，提供了一種適用於跨市場應用的**遷移學習框架**，並為使用 **Transformer 自注意力機制** 提升金融市場的學習排序模型提供了新方向。


<a name="S2"></a>
## 2. **研究角度**

這篇論文的研究角度主要圍繞**遷移學習 (Transfer Learning) 在金融市場中的應用**，特別是如何在**數據稀缺環境**（如加密貨幣）下構建**泛化能力強的交易模型**。具體而言，該研究涵蓋以下幾個關鍵角度：

**1. 遷移學習與跨市場知識遷移**  
- **核心問題**：在交易數據有限（如新興市場或歷史較短的資產類別）的情況下，傳統深度學習方法容易**過擬合**，導致策略無法有效應用於實際市場。  
- **研究思路**：
  - **利用外部市場數據**（如外匯市場）作為源數據，幫助學習有價值的模式，並將其轉移到數據較少的加密貨幣市場。  
  - 通過**雙編碼器架構 (Dual Encoder Architecture)**，將源市場的知識與目標市場的特性融合，以減少「負遷移 (Negative Transfer)」的影響。  
- **研究貢獻**：  
  - 拓展了遷移學習技術在**金融市場建模**中的應用，特別是在**低頻交易 (Low-frequency Trading)** 場景下的可行性。

**2. 深度學習與學習排序 (Learning to Rank, LTR) 在金融交易中的應用**  
- **核心問題**：傳統的**回歸預測 (Regression-based Models)** 在金融市場應用中，通常無法直接優化交易策略的最終目標（如收益最大化）。  
- **研究思路**：
  - 改進傳統的**學習排序技術 (LTR)**，利用**Transformer 自注意力機制 (Self-Attention)** 來提升市場信號的排序能力。  
  - 相較於傳統的 **LambdaMART**（基於梯度提升決策樹 GBDT 的排序方法），FEN **能夠捕捉資產之間的相互關係**，從而提高排序的準確性。  
- **研究貢獻**：  
  - 提出了新的**遷移學習排序模型 (Transfer Ranking Model)**，可應用於**動能交易策略 (Momentum Trading Strategies)**，拓展了學習排序技術在金融市場中的使用範圍。


**3. 動能交易 (Momentum Trading) 在加密貨幣市場的有效性**  
- **核心問題**：傳統的動能交易策略（基於歷史回報進行排序並買入/賣出）在股票市場已被廣泛研究，但其在加密貨幣市場的適用性仍不明確。  
- **研究思路**：
  - 透過 FEN 模型進行排名預測，篩選出**表現最強與最弱**的加密貨幣，進行**長/短頭寸 (Long/Short Positions)**。  
  - 透過對比不同的排序模型（如 MLP、LambdaMART、傳統動能策略），驗證深度學習是否能提升交易策略的效果。  
- **研究貢獻**：
  - 提供了一個**基於機器學習的動能交易框架**，能夠適應數據稀缺的市場環境，如新興市場和加密貨幣。

**4. 交易成本與市場實用性分析**  
- **核心問題**：加密貨幣市場具有**較高的交易成本**（如滑點與手續費），而傳統的機器學習模型通常忽略這一因素，導致理論與實際應用存在差距。  
- **研究思路**：
  - 透過計算**交易週轉率 (Turnover Rate)**，分析 FEN 模型的交易頻率，確保策略在實際市場中可行。  
  - 模擬不同的交易成本場景（如 0-30 個基點），檢測策略的穩健性，並發現 FEN 即使在高交易成本環境下仍可保持**正的 Sharpe Ratio**。  
- **研究貢獻**：
  - 強調了交易成本對機器學習交易策略的影響，並驗證了 FEN 在現實交易環境中的適用性。

**5. 自注意力機制 (Self-Attention) 在市場信號解釋中的應用**  
- **核心問題**：金融市場的機器學習模型通常是**黑盒子**，難以解釋模型如何做出決策。  
- **研究思路**：
  - 分析**注意力權重 (Attention Weights)**，觀察模型如何根據市場狀態（如風險事件、單一資產波動）調整預測結果。  
  - 研究發現：
    - 在**市場風險上升 (Risk-off events)** 時，FEN 模型的注意力機制會分散到**多個資產**，反映市場的系統性風險。  
    - 在**特定市場事件 (如 Elon Musk 推特影響 Dogecoin)** 時，模型能夠專注於特定資產，顯示出**模型的可解釋性**。  
- **研究貢獻**：
  - 展示了 Transformer **注意力機制的解釋能力**，有助於理解模型的交易決策機制，提升市場應用的透明度。

**綜合分析**  
本研究從 **遷移學習、學習排序、動能交易、交易成本影響、以及模型解釋性** 等角度出發，提出了一個新的金融機器學習框架，並通過大量實驗驗證其有效性。

這篇論文的主要貢獻包括：
1. **拓展遷移學習技術在金融市場的應用**，特別是針對數據稀缺市場的交易策略優化。  
2. **結合 Transformer 模型與學習排序技術**，提供新的基於自注意力的金融市場排名方法。  
3. **驗證動能交易策略在加密貨幣市場的可行性**，並量化交易成本對機器學習模型的影響。  
4. **提升機器學習交易模型的可解釋性**，使其更適合實際應用。  

這些研究角度為**金融市場中的深度學習應用**提供了新的視角，並為未來在其他資產類別（如股票、債券、外匯）的機器學習交易策略研究奠定了基礎。


<a name="S3"></a>
## 3. **研究方法**

本研究採用了**遷移學習 (Transfer Learning)** 和**學習排序 (Learning to Rank, LTR)** 技術，並設計了一種新模型——**Fused Encoder Networks (FEN)**，應用於加密貨幣的跨橫斷面動能交易策略。研究方法主要涵蓋以下幾個方面：

**1. 整體研究框架**  
本研究的核心是**將遷移學習應用於金融市場的動能交易策略**，特別是針對**數據有限的加密貨幣市場**。具體步驟如下：
1. **構建源數據模型 (Source Model)**：
   - 在歷史較長的外匯市場數據 (FX) 上訓練一個學習排序模型，以提取通用的市場模式。
2. **遷移學習 (Transfer Learning) 到目標市場**：
   - 透過**共享編碼器 (Shared Encoder) 與自注意力機制 (Self-Attention Mechanism)**，將源市場的特徵遷移到加密貨幣市場。
3. **回測與性能評估**：
   - 在加密貨幣市場進行歷史回測，並與多種基準模型比較，以評估 FEN 模型的交易表現。

**2. 模型架構：Fused Encoder Networks (FEN)**  
FEN 模型主要包含兩個編碼器：
- **源市場編碼器 (Source Encoder, SE)**：從外匯市場數據中學習特徵，並在遷移後的模型中保持不變（或部分調整）。
- **目標市場編碼器 (Target Encoder, TE)**：專門針對加密貨幣市場進行調整，以適應特定市場特性。

**FEN 模型的關鍵技術**
1. **雙編碼器架構 (Dual Encoder Architecture)**  
   - **源市場編碼器 (SE)**：從外匯市場數據中學習特徵。
   - **目標市場編碼器 (TE)**：針對加密貨幣市場進行調整。
   - 兩者**並行運行 (Parallel Execution)**，最終將輸出融合。

2. **自注意力機制 (Self-Attention Mechanism)**
   - 透過 Transformer 的 **Multi-head Attention**，學習資產之間的關聯性，提升排名模型的準確性。

3. **參數共享與微調 (Parameter Sharing & Fine-tuning)**
   - 源市場的編碼器可以部分凍結，僅對目標市場的部分進行微調，以避免過擬合。

4. **學習排序 (Learning to Rank, LTR)**
   - 使用 **ListNet** 作為主要損失函數 (Loss Function)，確保模型學習到最優的資產排序方式。

**3. 數據來源與特徵工程**  
**(a) 源數據 (Source Data)**
- **市場**：外匯市場 (FX)
- **資產**：31 種外匯貨幣對
- **時間範圍**：2000-2021
- **特徵 (Features)**：
  - **過去 1、2、3、4 週的收益率**
  - **標準化收益率 (Normalized Returns)**
  - **市場風險指標 (VIX)**
  - **市場情緒特徵**

**(b) 目標數據 (Target Data)**
- **市場**：加密貨幣市場 (Cryptocurrency)
- **資產**：10 種加密貨幣（BTC、ETH、DOGE 等）
- **時間範圍**：2016-2021
- **特徵 (Features)**：
  - **過去 1、2、3 週的收益率**
  - **標準化收益率**
  - **市場風險指標**
  - **市場情緒特徵**

**(c) 資料預處理 (Data Preprocessing)**
- **標準化 (Standardization)**：所有特徵變數標準化，確保不同資產間的特徵值在可比較範圍內。
- **去極值 (Winsorization)**：對極端數據進行裁剪，確保不受異常值影響。
- **數據增強 (Data Augmentation)**：在遷移學習階段，對源市場數據進行隨機擾動，以提升模型的泛化能力。

**4. 交易策略與回測**  
**(a) 交易信號產生**
- **排名機制**：
  - 使用 FEN 模型進行資產排名。
  - 選取排名最高的 2 個資產做 **多頭 (Long Positions)**，排名最低的 2 個資產做 **空頭 (Short Positions)**。

- **風險管理 (Risk Management)**：
  - **波動性調整 (Volatility Scaling)**：目標波動率設為 15%，以確保回報與風險的平衡。
  - **最大回撤控制 (Max Drawdown Control)**：若連續損失超過特定閾值，則降低槓桿。

**(b) 回測設計 (Backtesting Design)**
- **回測時間範圍**：2018-2021
- **擴展窗口 (Expanding Window) 訓練策略**：
  - 第一階段：訓練 2016-2017 數據，測試 2018 年市場。
  - 第二階段：訓練 2016-2018 數據，測試 2019 年市場。
  - 依此類推，每次增加一年的數據進行訓練。

**5. 評估指標 (Performance Metrics)**  
**(a) 交易績效 (Trading Performance)**  
- **期望報酬率 (E[Returns])**
- **波動率 (Volatility)**
- **夏普比率 (Sharpe Ratio)**
- **Sortino 比率 (Sortino Ratio)**
- **Calmar 比率 (Calmar Ratio)**

**(b) 風險管理 (Risk Management)**  
- **最大回撤 (Max Drawdown)**
- **下行標準差 (Downside Deviation)**

**(c) 排名準確性 (Ranking Accuracy)**  
- **標準化折扣累積增益 (NDCG@2)**  
  - 衡量 FEN 在選擇交易資產時的準確度。

**(d) 交易成本分析 (Transaction Cost Analysis)**  
- **不同交易成本 (5、10、15、20、25、30 bps) 下的策略表現**  
  - 檢測策略是否在高成本環境下仍能維持良好回報。

**6. 模型比較與基準 (Baselines for Comparison)**  
為驗證 FEN 的有效性，研究與以下模型進行比較：
1. **1 週動能策略 (1WR)**  
   - 傳統動能交易策略，僅根據過去 1 週回報率進行排序。
2. **多層感知機 (MLP)**  
   - 基於回歸預測的深度學習模型。
3. **LambdaMART (LM)**  
   - 目前在信息檢索領域中表現最佳的學習排序方法。
4. **自注意力排名器 (SAR)**  
   - 直接應用 Transformer 模型進行排名。
5. **SAR+ps (參數共享版 SAR)**  
   - 先在外匯數據上預訓練，再遷移到加密貨幣市場。

**總結**  
本研究方法結合**遷移學習**、**學習排序**、**自注意力機制**，並透過 **FEN 模型** 提升加密貨幣市場的動能交易策略。實驗結果顯示，該方法能夠有效提升交易績效、降低風險，並在高交易成本環境下仍具有實用性。


<a name="S4"></a>
## 4. **研究結果**



<a name="S5"></a>
## 5. **研究結論**

該研究提出了一種新的混合參數共享遷移排名模型 **Fused Encoder Networks (FEN)**，以解決神經排序模型在交易歷史較短的金融工具上的適用性問題。研究將其應用於基於動能策略的加密貨幣交易，並驗證了其有效性。

1. **FEN模型的優勢**：
   - 在跨橫斷面動能交易應用中，FEN 相較於其他基準（如傳統學習排序模型、樹狀決策模型和神經排序模型）表現更優。
   - 該模型在 **夏普比率 (Sharpe Ratio)** 上取得了大約 **三倍** 的提升（相較於傳統基準模型），並比最優基準提升了 **50%**。

2. **風險管理與穩健性**：
   - FEN 擁有較低的波動性、較小的最大回撤（Max Drawdown），且在高市場成本環境下仍能保持正的風險調整後回報。
   - 在不同市場環境下（包括風險事件），該模型的注意力機制可以適應市場變化，顯示出解釋性與穩健性。

3. **遷移學習的效果**：
   - 傳統的參數共享策略（如SAR+ps）在遷移學習中表現不佳，因為僅依賴外部市場數據（如外匯數據）進行預訓練並不足以適應加密貨幣市場。
   - FEN通過並行運行預訓練的編碼器模塊，允許從源數據和目標數據中靈活提取信息，減少了負遷移的風險。

4. **交易成本與可行性**：
   - 在考慮高交易成本（高達 29 個基點）時，FEN 仍能保持正的 **Sharpe Ratio**，顯示出其在真實市場交易中的可行性。

**研究貢獻：**
- 該研究在金融市場應用上擴展了 **遷移學習** 和 **學習排序 (Learning to Rank, LTR)** 方法，並展示了如何利用 **Transformer** 自注意力機制改善交易決策。
- 與傳統方法相比，FEN 在排名準確性、風險調整後回報和市場適應性方面都顯示出更佳的表現。

總結來說，這篇論文成功展示了 FEN 在應對 **數據稀缺**（如新興市場或歷史較短的交易品種）時的有效性，並提供了一種可行的 **遷移學習排序方法**，可應用於金融市場的跨橫斷面交易策略。
